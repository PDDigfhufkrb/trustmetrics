<!DOCTYPE html>
<html>
<head>
    <title>Тест оплаты ShadowBoost</title>
</head>
<body style="font-family: Arial; padding: 20px;">
    <h2>Тест оплаты ShadowBoost</h2>
    <p>Выберите метод оплаты:</p>
    
    <!-- Вариант 1: Оригинальная форма ЮKassa -->
    <h3>1. ЮKassa (shopId: 1256818)</h3>
    <form target="_blank" action="https://yookassa.ru/integration/simplepay/payment" method="post">
        <input type="hidden" name="shopId" value="1256818">
        <input type="hidden" name="sum" value="1">
        <input type="hidden" name="text" value="Тест оплаты">
        <input type="hidden" name="paymentSubjectType" value="service">
        <input type="hidden" name="paymentMethodType" value="full_prepayment">
        <input type="hidden" name="tax" value="1">
        <input type="hidden" name="shopSuccessURL" value="https://shadowboost.ru/success">
        
        <input type="email" name="email" placeholder="Email" required value="test@test.ru"><br><br>
        <button type="submit">Оплатить 1 рубль через ЮKassa</button>
    </form>
    
    <hr>
    
    <!-- Вариант 2: Альтернативная форма с тестовым shopId -->
    <h3>2. ЮKassa с тестовым shopId</h3>
    <form target="_blank" action="https://yookassa.ru/integration/simplepay/payment" method="post">
        <input type="hidden" name="shopId" value="834785"> <!-- Тестовый shopId -->
        <input type="hidden" name="sum" value="1">
        <input type="hidden" name="text" value="Тест оплаты">
        <input type="hidden" name="paymentSubjectType" value="service">
        <input type="hidden" name="tax" value="1">
        
        <input type="email" name="email" placeholder="Email" required value="test@test.ru"><br><br>
        <button type="submit">Оплатить 1 рубль (тестовый shopId)</button>
    </form>
    
    <hr>
    
    <!-- Вариант 3: Упрощенная форма без лишних параметров -->
    <h3>3. Минимальная форма</h3>
    <form target="_blank" action="https://yookassa.ru/integration/simplepay/payment" method="post">
        <input type="hidden" name="shopId" value="1256818">
        <input type="hidden" name="sum" value="1">
        <input type="hidden" name="text" value="Тест">
        <input type="email" name="email" value="test@test.ru">
        <br><br>
        <button type="submit">Простая оплата 1 рубль</button>
    </form>
    
    <hr>
    
    <!-- Диагностическая информация -->
    <div style="background: #f0f0f0; padding: 15px; margin-top: 20px;">
        <h3>Диагностика проблемы:</h3>
        <p>Ошибка 404 означает: shopId <strong>1256818</strong> не найден в системе ЮKassa.</p>
        <p><strong>Что проверить:</strong></p>
        <ol>
            <li>Войдите в личный кабинет ЮKassa</li>
            <li>Проверьте, активен ли магазин с ID 1256818</li>
            <li>Проверьте настройки магазина → "Прием платежей" должен быть включен</li>
            <li>Проверьте домен shadowboost.ru в настройках безопасности</li>
            <li>Попробуйте создать новый магазин в ЮKassa и получить новый shopId</li>
        </ol>
        <p><strong>Альтернатива:</strong> Если ЮKassa не работает, подключите другой платежный агрегатор:
        <ul>
            <li><a href="https://cloudpayments.ru/" target="_blank">CloudPayments</a></li>
            <li><a href="https://www.rbs.ru/" target="_blank">СберБизнес</a></li>
            <li><a href="https://robokassa.ru/" target="_blank">Robokassa</a></li>
        </ul>
        </p>
    </div>
    
    <!-- Тест доступности shopId -->
    <script>
        // Простой тест доступности shopId
        console.log('Тестируем shopId: 1256818');
        
        // Проверка: попробуем отправить запрос к API ЮKassa
        fetch('https://api.yookassa.ru/v3/payments', {
            method: 'POST',
            headers: {
                'Authorization': 'Basic ' + btoa('1256818:live_cQ08CM2pew_mp5eFgigDtmvoO-guM_QHyU1FvyuoMVg'),
                'Content-Type': 'application/json',
                'Idempotence-Key': 'test-' + Date.now()
            },
            body: JSON.stringify({
                amount: { value: "1.00", currency: "RUB" },
                description: "Тест оплаты",
                confirmation: { type: "redirect", return_url: "https://shadowboost.ru/success" },
                metadata: { test: true }
            })
        })
        .then(response => {
            console.log('Статус ответа:', response.status);
            if (response.status === 401 || response.status === 404) {
                console.error('❌ Ошибка авторизации. ShopId или секретный ключ неверны.');
            } else if (response.status === 201) {
                console.log('✅ ShopId валиден!');
            }
            return response.json();
        })
        .then(data => console.log('Ответ:', data))
        .catch(error => console.error('Ошибка:', error));
    </script>
</body>
</html>
